US-001 completed (E2E infrastructure only):
- Added temp project fixture helper: `e2e/helpers/projectFixture.ts`
- Added global write guard snapshot/assertion for `~/.config/notionflow`
- Added E2E usage test: `e2e/local-project-helpers.test.ts`
- Verified: `npm run test:e2e -- e2e/local-project-helpers.test.ts` passes
- Note: `npm run check` currently fails due pre-existing implicit-any issues in existing `e2e/factories/*.ts` files not touched in this task

US-002 completed (E2E init scaffold validation):
- Added `init` CLI command: `src/commands/init.ts`
- Wired `init` subcommand into CLI: `src/cli.ts`
- Added E2E test: `e2e/local-project-init.test.ts`
- Test validates `notionflow.config.ts`, `factories/`, and `.notionflow/` are created
- Test validates `.gitignore` contains exactly one `.notionflow/` entry after running `init` twice
- Test validates no writes under `~/.config/notionflow` during init flow
- Verified: `npm run test:e2e -- e2e/local-project-init.test.ts` passes

US-003 completed (E2E doctor nested config discovery):
- Added project config walk-up helper: `src/project/discoverConfig.ts`
- Updated `doctor` command to resolve nearest `notionflow.config.ts` and print resolved `Project root` and `Config path`: `src/commands/doctor.ts`
- Removed `doctor` dependency on `openApp()` to avoid global runtime writes for this flow
- Added E2E test: `e2e/local-project-doctor.test.ts`
- Test validates `doctor` run from nested directory resolves ancestor project root/config path
- Test validates no writes under `~/.config/notionflow` during init + doctor scenario
- Verified: `npm run test:e2e -- e2e/local-project-doctor.test.ts` passes
- Note: `npm run check` still fails due pre-existing implicit-any issues in `e2e/factories/*.ts` files not touched in this task

US-004 completed (E2E factory create in local project):
- Updated `factory create` to resolve local project context via `notionflow.config.ts` and scaffold to `<project>/factories/<id>.ts`: `src/commands/factory.ts`
- Removed global runtime dependency from `factory create` path so command no longer requires `openApp()`/global DB writes for scaffold flow
- Added E2E test: `e2e/local-project-factory-create.test.ts`
- Test validates `factory create --id smoke --skip-notion-board` creates `factories/smoke.ts` in temp project
- Test validates no writes under `~/.config/notionflow` during init + factory create scenario
- Verified: `npm run test:e2e -- e2e/local-project-factory-create.test.ts` passes

US-005 completed (project context resolver + `--config` override):
- Added shared resolver with explicit config-path validation/normalization and actionable error context: `src/project/discoverConfig.ts`
- Updated `doctor` to use shared resolver and support `--config <path>` with clear start/attempted path diagnostics: `src/commands/doctor.ts`
- Updated `factory create` to use shared resolver and support `--config <path>` from outside project roots: `src/commands/factory.ts`
- Extended E2E doctor coverage for walk-up, explicit `--config` override, and missing-config non-zero failures with contextual error output: `e2e/local-project-doctor.test.ts`
- Extended E2E factory-create coverage for `--config` execution from outside the project root: `e2e/local-project-factory-create.test.ts`
- Verified: `npm run test:e2e -- e2e/local-project-doctor.test.ts e2e/local-project-factory-create.test.ts` passes
- Note: `npm run check` still fails due pre-existing implicit-any issues in `e2e/factories/*.ts` files not touched in this task

US-006 completed (explicit factory declarations and deterministic loader primitives):
- Added typed project config schema/loader with explicit `factories: string[]` declarations and actionable config-load errors: `src/project/projectConfig.ts`
- Added deterministic factory path resolution from config entries (relative-to-project-root or absolute) with no implicit glob/directory scanning: `src/project/projectConfig.ts`
- Added declared-factory loading helper that only loads explicitly listed modules and wraps per-path failures with offending declaration context: `src/project/projectConfig.ts`
- Added unit tests for explicit path resolution and non-scanning behavior with unlisted invalid factory files present: `src/project/projectConfig.test.ts`
- Verified: `npm run test -- src/project/projectConfig.test.ts` passes
- Note: `npm run check` still fails due pre-existing implicit-any issues in `e2e/factories/*.ts` files not touched in this task

US-007 completed (fail-fast invalid declarations and duplicate IDs):
- Added explicit missing-file guard for declared factory paths with clear declared/resolved path diagnostics before module load: `src/project/projectConfig.ts`
- Added duplicate factory-id detection in declared-factory loader with conflicting ID plus first/duplicate declaration and resolved path context: `src/project/projectConfig.ts`
- Added unit coverage for missing declared path errors and duplicate factory-id failures across declared files: `src/project/projectConfig.test.ts`
- Verified: `npm run test -- src/project/projectConfig.test.ts` passes
- Note: `npm run check` still fails due pre-existing implicit-any issues in `e2e/factories/*.ts` files not touched in this task

US-008 completed (project-local runtime artifacts under `.notionflow`):
- Refactored runtime path resolution to be project-root based via `resolveRuntimePaths(projectRoot)` and updated default runtime constants (`db`, `runtime.log`, `errors.log`) under `<project>/.notionflow`: `src/config/paths.ts`
- Updated `openApp()` to resolve project context (walk-up config discovery or `NOTIONFLOW_PROJECT_ROOT` override), create runtime directories idempotently, and ensure DB/log files are created inside project-local `.notionflow`: `src/app/context.ts`
- Updated runtime factory module lookup to use `openApp()` resolved runtime paths instead of static global path imports: `src/core/factoryRuntime.ts`
- Updated factory install path usage to source workflow install target from resolved app runtime paths: `src/commands/factory.ts`
- Updated runtime unit test harness to use isolated per-test project roots through `NOTIONFLOW_PROJECT_ROOT`: `src/core/factoryRuntime.test.ts`
- Added E2E coverage validating local runtime artifacts and global-write guard (`init` + repeated runtime command): `e2e/local-project-runtime-artifacts.test.ts`
- Verified: `npm run test -- src/core/factoryRuntime.test.ts` passes
- Verified: `npm run test:e2e -- e2e/local-project-runtime-artifacts.test.ts` passes
- Note: `npm run check` still fails due pre-existing implicit-any issues in `e2e/factories/*.ts` files not touched in this task

US-009 completed (`run`/`tick` local execution with no install step):
- Removed `factory install` from the CLI command surface and updated Notion sync guidance text to stop referencing install flow: `src/commands/factory.ts`, `src/commands/notion.ts`
- Updated runtime factory resolution to prefer config-declared local factories (`notionflow.config.ts`) by factory ID on every run, with actionable error output when requested IDs are not declared: `src/core/factoryRuntime.ts`
- Added `--config <path>` passthrough for `run`, `tick`, and `integrations notion sync` so local project resolution can be explicit outside project roots: `src/commands/run.ts`, `src/commands/tick.ts`, `src/commands/notion.ts`
- Added E2E coverage proving `run` executes directly from declared local factory files, picks up file edits without install/copy, enforces removed `factory install` surface, and preserves no-write guard for `~/.config/notionflow`: `e2e/local-project-run-local-factory.test.ts`
- Verified: `npm run test -- src/project/projectConfig.test.ts` passes
- Verified: `npm run test -- src/core/factoryRuntime.test.ts` passes
- Verified: `npm run test:e2e -- e2e/local-project-run-local-factory.test.ts` passes
- Note: `npm run check` still fails due pre-existing implicit-any issues in `e2e/factories/*.ts` files not touched in this task

US-010 completed (continuous tick loop with backoff and graceful shutdown):
- Added loop-capable tick execution engine with explicit `--loop` mode, default 2000ms cycle delay, retryable Notion API backoff handling (429/5xx), jitter, and 15000ms cap: `src/commands/tick.ts`
- Added runtime/error log writes for cycle start/complete, sleep, retryable backoff decisions, and signal-triggered shutdown events under project-local `.notionflow`: `src/commands/tick.ts`
- Added signal-safe shutdown handling for `SIGINT`/`SIGTERM` that completes the in-flight cycle and avoids scheduling further cycles: `src/commands/tick.ts`
- Added unit tests for one-shot default behavior, exponential backoff schedule/cap, and graceful signal shutdown behavior: `src/commands/tick.test.ts`
- Verified: `npm run test -- src/commands/tick.test.ts` passes
- Verified: `npm run test -- src/core/factoryRuntime.test.ts` passes
- Verified: `npm run test:e2e -- e2e/local-project-runtime-artifacts.test.ts` passes
- Note: `npm run check` still fails due pre-existing implicit-any issues in `e2e/factories/*.ts` files not touched in this task

US-011 completed (stable typed library API exports):
- Added package root entrypoint and explicit exports map for typed library usage via `import ... from "notionflow"`: `package.json`, `src/index.ts`
- Added typed `defineFactory` helper alongside existing typed `defineConfig` authoring API: `src/core/factorySchema.ts`, `src/project/projectConfig.ts`
- Added approved typed runtime helper utilities (`agent`, `select`, `until`) plus result/type exports for shared modules: `src/factory/helpers.ts`, `src/index.ts`
- Added API contract tests for explicit public runtime export surface and package-root typecheck coverage: `src/index.test.ts`
- Added compile fixture demonstrating package-root imports for config, factory, and shared helper modules: `e2e/fixtures/library-api/*`
- Verified: `npm run test -- src/index.test.ts` passes
- Verified: `npm run test -- src/project/projectConfig.test.ts` passes
- Verified: `npm run test -- src/core/factorySchema.test.ts` passes
- Note: `npm run check` still fails due pre-existing implicit-any issues in `e2e/factories/*.ts` and an existing type error in `src/commands/tick.test.ts` not touched in this task
